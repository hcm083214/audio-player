/* var qmys=[{"time":26,"lineLyric":"窗透初晓 日照西桥 云自摇"},{"time":33,"lineLyric":"想你当年荷风微摆的衣角"},{"time":40,"lineLyric":"木雕流金 岁月涟漪 七年前封笔"},{"time":46,"lineLyric":"因为我今生挥毫只为你"},{"time":51,"lineLyric":"雨打湿了眼眶 年年倚井盼归堂"},{"time":59,"lineLyric":"最怕不觉泪已拆两行"},{"time":66,"lineLyric":"我在人间彷徨 寻不到你的天堂"},{"time":73,"lineLyric":"东瓶西镜放 恨不能遗忘"},{"time":80,"lineLyric":"又是清明雨上 折菊寄到你身旁"},{"time":85,"lineLyric":"把你最爱的歌来轻轻唱"},{"time":108,"lineLyric":"远方有琴 愀然空灵 声声催天雨"},{"time":113,"lineLyric":"涓涓心事说给自己听"},{"time":119,"lineLyric":"月影憧憧 烟火几重 烛花红"},{"time":125,"lineLyric":"红尘旧梦 梦断都成空"},{"time":132,"lineLyric":"雨打湿了眼眶 年年倚井盼归堂"},{"time":140,"lineLyric":"最怕不觉泪已拆两行"},{"time":145,"lineLyric":"我在人间彷徨 寻不到你的天堂"},{"time":152,"lineLyric":"东瓶西镜放 恨不能遗忘"},{"time":158,"lineLyric":"又是清明雨上 折菊寄到你身旁"},{"time":165,"lineLyric":"把你最爱的歌来轻轻唱"},{"time":172,"lineLyric":"我在人间彷徨 寻不到你的天堂"},{"time":178,"lineLyric":"东瓶西镜放 恨不能遗忘"},{"time":185,"lineLyric":"又是清明雨上 折菊寄到你身旁"},{"time":192,"lineLyric":"把你最爱的歌来轻轻唱"},{"time":200,"lineLyric":""},{"time":204,"lineLyric":""},{"time":1768,"lineLyric":""}];
var hktk=[{"time":0,"lineLyric":""},{"time":0,"lineLyric":"词：黄家驹"},{"time":0,"lineLyric":"曲：黄家驹"},{"time":2,"lineLyric":""},{"time":18,"lineLyric":"今天我 寒夜里看雪飘过"},{"time":25,"lineLyric":"怀着冷却了的心窝漂远方"},{"time":29,"lineLyric":""},{"time":31,"lineLyric":"风雨里追赶 雾里分不清影踪"},{"time":36,"lineLyric":""},{"time":37,"lineLyric":"天空海阔你与我"},{"time":40,"lineLyric":"可会变 (谁没在变)"},{"time":43,"lineLyric":"多少次迎着冷眼与嘲笑"},{"time":50,"lineLyric":"从没有放弃过心中的理想"},{"time":54,"lineLyric":""},{"time":55,"lineLyric":"一刹那恍惚 若有所失的感觉"},{"time":62,"lineLyric":"不知不觉已变淡"},{"time":65,"lineLyric":"心里爱 (谁明白我)"},{"time":68,"lineLyric":""},{"time":68,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":74,"lineLyric":""},{"time":75,"lineLyric":"也会怕有一天会跌倒"},{"time":80,"lineLyric":""},{"time":82,"lineLyric":"背弃了理想 谁人都可以"},{"time":87,"lineLyric":""},{"time":88,"lineLyric":"哪会怕有一天只你共我"},{"time":91,"lineLyric":""},{"time":103,"lineLyric":"今天我 寒夜里看雪飘过"},{"time":108,"lineLyric":""},{"time":109,"lineLyric":"怀着冷却了的心窝漂远方"},{"time":114,"lineLyric":""},{"time":115,"lineLyric":"风雨里追赶 雾里分不清影踪"},{"time":120,"lineLyric":""},{"time":121,"lineLyric":"天空海阔你与我"},{"time":124,"lineLyric":"可会变 (谁没在变)"},{"time":127,"lineLyric":""},{"time":128,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":133,"lineLyric":""},{"time":135,"lineLyric":"也会怕有一天会跌倒"},{"time":140,"lineLyric":""},{"time":141,"lineLyric":"背弃了理想 谁人都可以"},{"time":146,"lineLyric":""},{"time":147,"lineLyric":"哪会怕有一天只你共我"},{"time":151,"lineLyric":""},{"time":188,"lineLyric":"仍然自由自我 永远高唱我歌"},{"time":194,"lineLyric":""},{"time":195,"lineLyric":"走遍千里"},{"time":199,"lineLyric":""},{"time":200,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":205,"lineLyric":""},{"time":207,"lineLyric":"也会怕有一天会跌倒"},{"time":211,"lineLyric":""},{"time":213,"lineLyric":"背弃了理想 谁人都可以"},{"time":218,"lineLyric":""},{"time":219,"lineLyric":"哪会怕有一天只你共我"},{"time":224,"lineLyric":""},{"time":225,"lineLyric":"背弃了理想 谁人都可以"},{"time":230,"lineLyric":""},{"time":231,"lineLyric":"哪会怕有一天只你共我"},{"time":236,"lineLyric":""},{"time":237,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":242,"lineLyric":""},{"time":244,"lineLyric":"也会怕有一天会跌倒"},{"time":248,"lineLyric":""},{"time":250,"lineLyric":"背弃了理想 谁人都可以"},{"time":255,"lineLyric":""},{"time":256,"lineLyric":"哪会怕有一天只你共我"},{"time":"","lineLyric":""}];
var ls=[{"time":16,"lineLyric":"一张褪色的照片"},{"time":20,"lineLyric":"好像带给我一点点怀念"},{"time":23,"lineLyric":"巷尾老爷爷卖的热汤面"},{"time":27,"lineLyric":"味道弥漫过旧旧的后院"},{"time":31,"lineLyric":"流浪猫睡熟在摇晃秋千"},{"time":35,"lineLyric":"夕阳照了一遍他眯着眼"},{"time":40,"lineLyric":"那张同桌寄的明信片"},{"time":44,"lineLyric":"安静的躺在课桌的里面"},{"time":49,"lineLyric":"快要过完的春天"},{"time":51,"lineLyric":"还有雕刻着图案的门帘"},{"time":55,"lineLyric":"窄窄的长长的过道两边"},{"time":59,"lineLyric":"老房子依然升起了炊烟"},{"time":63,"lineLyric":"刚刚下完了小雨的季节"},{"time":67,"lineLyric":"爸妈又一起走过的老街"},{"time":72,"lineLyric":"记不得哪年的哪一天"},{"time":75,"lineLyric":"很漫长又很短暂的岁月"},{"time":80,"lineLyric":"现在已经回不去"},{"time":84,"lineLyric":"早已流逝的光阴"},{"time":88,"lineLyric":"手里的那一张渐渐模糊不清的车票"},{"time":93,"lineLyric":"成了回忆的信号"},{"time":97,"lineLyric":"忘不掉的是什么我也不知道"},{"time":102,"lineLyric":"想不起当年模样"},{"time":106,"lineLyric":"看也看不到 去也去不了的地方"},{"time":114,"lineLyric":"也许那老街的腔调是属于我的忧伤"},{"time":122,"lineLyric":"嘴角那点微笑越来越勉强"},{"time":128,"lineLyric":""},{"time":129,"lineLyric":"忘不掉的是什么我也不知道"},{"time":134,"lineLyric":"放不下熟悉片段"},{"time":138,"lineLyric":"回头望一眼 已经很多年的时间"},{"time":145,"lineLyric":"透过手指间看着天"},{"time":150,"lineLyric":"我又回到那老街"},{"time":154,"lineLyric":"靠在你们身边渐行渐远"},{"time":162,"lineLyric":""},{"time":190,"lineLyric":"快要过完的春天"},{"time":193,"lineLyric":"还有雕刻着图案的门帘"},{"time":197,"lineLyric":"窄窄的长长的过道两边"},{"time":201,"lineLyric":"老房子依然升起了炊烟"},{"time":205,"lineLyric":"刚刚下完了小雨的季节"},{"time":209,"lineLyric":"爸妈又一起走过的老街"},{"time":214,"lineLyric":"记不得哪年的哪一天"},{"time":217,"lineLyric":"很漫长又很短暂的岁月"},{"time":222,"lineLyric":"现在已经回不去"},{"time":226,"lineLyric":"早已流逝的光阴"},{"time":230,"lineLyric":"手里的那一张渐渐模糊不清的车票"},{"time":235,"lineLyric":"成了回忆的信号"},{"time":239,"lineLyric":"忘不掉的是什么我也不知道"},{"time":244,"lineLyric":"想不起当年模样"},{"time":248,"lineLyric":"看也看不到 去也去不了的地方"},{"time":255,"lineLyric":"也许那老街的腔调是属于我的忧伤"},{"time":264,"lineLyric":"嘴角那点微笑越来越勉强"},{"time":271,"lineLyric":"忘不掉的是什么我也不知道"},{"time":276,"lineLyric":"放不下熟悉片段"},{"time":280,"lineLyric":"回头望一眼 已经很多年的时间"},{"time":287,"lineLyric":"透过手指间看着天"},{"time":292,"lineLyric":"我又回到那老街"},{"time":296,"lineLyric":"靠在你们身边渐行渐远"}]; */
var songlist=[
    {name:"清明雨上",album:"Vae新歌+精选珍藏",url:"video/许嵩 - 清明雨上.mp3",pic:"img/许嵩_Vae新歌+精选珍藏合辑_4.jpg",singer:"许嵩",time:"03:40",songid:"qmys"},
    {name:"海阔天空",album:"海阔天空",url:"video/BEYOND - 海阔天空.mp3",pic:"img/BEYOND_海阔天空_4.jpg",singer:"BEYOND",time:"05:27",songid:"hktk"},
    {name:"老街",album:"小黄",url:"video/李荣浩 - 老街.mp3",pic:"img/李荣浩_小黄_4.jpg",singer:"李荣浩",time:"05:19",songid:"ls"}
    ];
var lrcs = [
            {"song":"qmys","lyric":[{"time":0,"lineLyric":""},{"time":26,"lineLyric":"窗透初晓 日照西桥 云自摇"},{"time":33,"lineLyric":"想你当年荷风微摆的衣角"},{"time":40,"lineLyric":"木雕流金 岁月涟漪 七年前封笔"},{"time":46,"lineLyric":"因为我今生挥毫只为你"},{"time":51,"lineLyric":"雨打湿了眼眶 年年倚井盼归堂"},{"time":59,"lineLyric":"最怕不觉泪已拆两行"},{"time":66,"lineLyric":"我在人间彷徨 寻不到你的天堂"},{"time":73,"lineLyric":"东瓶西镜放 恨不能遗忘"},{"time":80,"lineLyric":"又是清明雨上 折菊寄到你身旁"},{"time":85,"lineLyric":"把你最爱的歌来轻轻唱"},{"time":108,"lineLyric":"远方有琴 愀然空灵 声声催天雨"},{"time":113,"lineLyric":"涓涓心事说给自己听"},{"time":119,"lineLyric":"月影憧憧 烟火几重 烛花红"},{"time":125,"lineLyric":"红尘旧梦 梦断都成空"},{"time":132,"lineLyric":"雨打湿了眼眶 年年倚井盼归堂"},{"time":140,"lineLyric":"最怕不觉泪已拆两行"},{"time":145,"lineLyric":"我在人间彷徨 寻不到你的天堂"},{"time":152,"lineLyric":"东瓶西镜放 恨不能遗忘"},{"time":158,"lineLyric":"又是清明雨上 折菊寄到你身旁"},{"time":165,"lineLyric":"把你最爱的歌来轻轻唱"},{"time":172,"lineLyric":"我在人间彷徨 寻不到你的天堂"},{"time":178,"lineLyric":"东瓶西镜放 恨不能遗忘"},{"time":185,"lineLyric":"又是清明雨上 折菊寄到你身旁"},{"time":192,"lineLyric":"把你最爱的歌来轻轻唱"},{"time":200,"lineLyric":""},{"time":204,"lineLyric":""},{"time":1768,"lineLyric":""}]},
            {"song":"hktk","lyric":[{"time":0,"lineLyric":""},{"time":0,"lineLyric":"词：黄家驹"},{"time":0,"lineLyric":"曲：黄家驹"},{"time":2,"lineLyric":""},{"time":18,"lineLyric":"今天我 寒夜里看雪飘过"},{"time":25,"lineLyric":"怀着冷却了的心窝漂远方"},{"time":29,"lineLyric":""},{"time":31,"lineLyric":"风雨里追赶 雾里分不清影踪"},{"time":36,"lineLyric":""},{"time":37,"lineLyric":"天空海阔你与我"},{"time":40,"lineLyric":"可会变 (谁没在变)"},{"time":43,"lineLyric":"多少次迎着冷眼与嘲笑"},{"time":50,"lineLyric":"从没有放弃过心中的理想"},{"time":54,"lineLyric":""},{"time":55,"lineLyric":"一刹那恍惚 若有所失的感觉"},{"time":62,"lineLyric":"不知不觉已变淡"},{"time":65,"lineLyric":"心里爱 (谁明白我)"},{"time":68,"lineLyric":""},{"time":68,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":74,"lineLyric":""},{"time":75,"lineLyric":"也会怕有一天会跌倒"},{"time":80,"lineLyric":""},{"time":82,"lineLyric":"背弃了理想 谁人都可以"},{"time":87,"lineLyric":""},{"time":88,"lineLyric":"哪会怕有一天只你共我"},{"time":91,"lineLyric":""},{"time":103,"lineLyric":"今天我 寒夜里看雪飘过"},{"time":108,"lineLyric":""},{"time":109,"lineLyric":"怀着冷却了的心窝漂远方"},{"time":114,"lineLyric":""},{"time":115,"lineLyric":"风雨里追赶 雾里分不清影踪"},{"time":120,"lineLyric":""},{"time":121,"lineLyric":"天空海阔你与我"},{"time":124,"lineLyric":"可会变 (谁没在变)"},{"time":127,"lineLyric":""},{"time":128,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":133,"lineLyric":""},{"time":135,"lineLyric":"也会怕有一天会跌倒"},{"time":140,"lineLyric":""},{"time":141,"lineLyric":"背弃了理想 谁人都可以"},{"time":146,"lineLyric":""},{"time":147,"lineLyric":"哪会怕有一天只你共我"},{"time":151,"lineLyric":""},{"time":188,"lineLyric":"仍然自由自我 永远高唱我歌"},{"time":194,"lineLyric":""},{"time":195,"lineLyric":"走遍千里"},{"time":199,"lineLyric":""},{"time":200,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":205,"lineLyric":""},{"time":207,"lineLyric":"也会怕有一天会跌倒"},{"time":211,"lineLyric":""},{"time":213,"lineLyric":"背弃了理想 谁人都可以"},{"time":218,"lineLyric":""},{"time":219,"lineLyric":"哪会怕有一天只你共我"},{"time":224,"lineLyric":""},{"time":225,"lineLyric":"背弃了理想 谁人都可以"},{"time":230,"lineLyric":""},{"time":231,"lineLyric":"哪会怕有一天只你共我"},{"time":236,"lineLyric":""},{"time":237,"lineLyric":"原谅我这一生不羁放纵爱自由"},{"time":242,"lineLyric":""},{"time":244,"lineLyric":"也会怕有一天会跌倒"},{"time":248,"lineLyric":""},{"time":250,"lineLyric":"背弃了理想 谁人都可以"},{"time":255,"lineLyric":""},{"time":256,"lineLyric":"哪会怕有一天只你共我"},{"time":"","lineLyric":""}]},
            {"song":"ls","lyric":[{"time":0,"lineLyric":""},{"time":16,"lineLyric":"一张褪色的照片"},{"time":20,"lineLyric":"好像带给我一点点怀念"},{"time":23,"lineLyric":"巷尾老爷爷卖的热汤面"},{"time":27,"lineLyric":"味道弥漫过旧旧的后院"},{"time":31,"lineLyric":"流浪猫睡熟在摇晃秋千"},{"time":35,"lineLyric":"夕阳照了一遍他眯着眼"},{"time":40,"lineLyric":"那张同桌寄的明信片"},{"time":44,"lineLyric":"安静的躺在课桌的里面"},{"time":49,"lineLyric":"快要过完的春天"},{"time":51,"lineLyric":"还有雕刻着图案的门帘"},{"time":55,"lineLyric":"窄窄的长长的过道两边"},{"time":59,"lineLyric":"老房子依然升起了炊烟"},{"time":63,"lineLyric":"刚刚下完了小雨的季节"},{"time":67,"lineLyric":"爸妈又一起走过的老街"},{"time":72,"lineLyric":"记不得哪年的哪一天"},{"time":75,"lineLyric":"很漫长又很短暂的岁月"},{"time":80,"lineLyric":"现在已经回不去"},{"time":84,"lineLyric":"早已流逝的光阴"},{"time":88,"lineLyric":"手里的那一张渐渐模糊不清的车票"},{"time":93,"lineLyric":"成了回忆的信号"},{"time":97,"lineLyric":"忘不掉的是什么我也不知道"},{"time":102,"lineLyric":"想不起当年模样"},{"time":106,"lineLyric":"看也看不到 去也去不了的地方"},{"time":114,"lineLyric":"也许那老街的腔调是属于我的忧伤"},{"time":122,"lineLyric":"嘴角那点微笑越来越勉强"},{"time":128,"lineLyric":""},{"time":129,"lineLyric":"忘不掉的是什么我也不知道"},{"time":134,"lineLyric":"放不下熟悉片段"},{"time":138,"lineLyric":"回头望一眼 已经很多年的时间"},{"time":145,"lineLyric":"透过手指间看着天"},{"time":150,"lineLyric":"我又回到那老街"},{"time":154,"lineLyric":"靠在你们身边渐行渐远"},{"time":162,"lineLyric":""},{"time":190,"lineLyric":"快要过完的春天"},{"time":193,"lineLyric":"还有雕刻着图案的门帘"},{"time":197,"lineLyric":"窄窄的长长的过道两边"},{"time":201,"lineLyric":"老房子依然升起了炊烟"},{"time":205,"lineLyric":"刚刚下完了小雨的季节"},{"time":209,"lineLyric":"爸妈又一起走过的老街"},{"time":214,"lineLyric":"记不得哪年的哪一天"},{"time":217,"lineLyric":"很漫长又很短暂的岁月"},{"time":222,"lineLyric":"现在已经回不去"},{"time":226,"lineLyric":"早已流逝的光阴"},{"time":230,"lineLyric":"手里的那一张渐渐模糊不清的车票"},{"time":235,"lineLyric":"成了回忆的信号"},{"time":239,"lineLyric":"忘不掉的是什么我也不知道"},{"time":244,"lineLyric":"想不起当年模样"},{"time":248,"lineLyric":"看也看不到 去也去不了的地方"},{"time":255,"lineLyric":"也许那老街的腔调是属于我的忧伤"},{"time":264,"lineLyric":"嘴角那点微笑越来越勉强"},{"time":271,"lineLyric":"忘不掉的是什么我也不知道"},{"time":276,"lineLyric":"放不下熟悉片段"},{"time":280,"lineLyric":"回头望一眼 已经很多年的时间"},{"time":287,"lineLyric":"透过手指间看着天"},{"time":292,"lineLyric":"我又回到那老街"},{"time":296,"lineLyric":"靠在你们身边渐行渐远"}]},
            ]
/* 自动生成歌曲列表   */ 
for(var index in songlist){
    var $songListTr=$(".songlist-item-table>tbody>tr:first-child").clone();
    var $songListTbody=$(".songlist-item-table>tbody");
    $songListTbody.append($songListTr);
    var songName=songlist[index].name;
    var singer=songlist[index].singer;
    var songTime=songlist[index].time;
    //自动生成歌曲列表并添加click事件
    $(".songlist-item-table>tbody>tr:last-child .songlist-name").text(songName).attr("onclick","splay("+index+",this)");
    $(".songlist-item-table>tbody>tr:last-child .songlist-songer").text(singer).attr("onclick","splay("+index+",this)");
    $(".songlist-item-table>tbody>tr:last-child .songlist-time").text(songTime);
}
$(".songlist-item-table>tbody>tr:first-child").remove();
/* click事件触发播放音乐并更改背景图片 */
function splay(index,e){
    var mysrc= songlist[index].url;
    $("#myaudio").attr("src",mysrc);
    $(".song-img").css("background-image","url("+songlist[index].pic+")");
    $("#myaudio")[0].play();
    var songname=songlist[index].songid;
    noplay=0;
    play(); 
    lyricShow(songname,index,e);
    //默认播放模式为1：顺序播放
    cycle(1);
}
/* 歌曲播放循环模式设置 */
//默认播放模式为列表播放，定义变量cycleMode判断点击次数
//cycleMode=1 顺序播放  cycleMode=2 单曲播放 cycleMode=3 随机播放
var cycleMode=1;
var songTotal=songlist.length;
var myaudio=document.getElementById("myaudio");
$("#mycycle").click(function(){
    cycleMode=cycleMode<3?++cycleMode:1;
    console.log("cycleMode局部:"+cycleMode);
    if(cycleMode==1){
        $("#mycycle").attr("class","playerIcon songCycleOrder");
    }else if(cycleMode==2){
        $("#mycycle").attr("class","playerIcon songCycleOnly");
    }else if(cycleMode==3){
        $("#mycycle").attr("class","playerIcon songCycleRandom");
    }
    //cycle(cycleMode);
});
//获取当前歌曲的序号  
var sn=$(".song-name").text();
var songIndex,songNext;
for(var sIndex in songlist){
    if(sn==songlist[sIndex].name){
        songIndex=parseInt(sIndex);
    }
}
//歌曲循环模式
myaudio.addEventListener("ended",cycle(cycleMode),false);
    function cycle(cMode){
        $(".albumRotate").css("animation-play-state","paused");
        if(cMode==1){
            //顺序播放模式
            (songIndex+1)<songTotal?($("#myaudio").attr("src",songlist[songIndex+1].url)):($("#myaudio").attr("src",songlist[0].url));
            noplay=0;
            play();
            songIndex=(songIndex+1)<songTotal?++songIndex:0;
            //歌词显示
            lyricShow(songlist[songIndex].songid,songIndex,this);
            console.log(cMode,songIndex,songlist[songIndex].url,this);
            $(".song-img").css("background-image","url("+songlist[songIndex].pic+")");     
        }else if(cMode==2){
            $("#myaudio").attr("src",songlist[songIndex].url);
            noplay=0;
            play();
            lyricShow(songlist[songIndex].songid,songIndex,this);
            console.log(cMode,songIndex,songlist[songIndex].url,songIndex);
            $(".song-img").css("background-image","url("+songlist[songIndex].pic+")"); 
        }else if(cMode==3){
            var songNext=parseInt(Math.random()*songTotal);
            $("#myaudio").attr("src",songlist[songNext].url);
            noplay=0;
            play();
            lyricShow(songlist[songNext].songid,songNext,this);
            console.log(cMode,songNext,songlist[songNext].url,songNext);   
            $(".song-img").css("background-image","url("+songlist[songNext].pic+")");    
        }
    }

/* 加载显示歌词 */
function lyricShow(name,songIndex,event){
     //改变歌曲名及信息
     $(".song .song-name").text(songlist[songIndex].name);
     $(".song-info .song-album a").text(songlist[songIndex].album);
     $(".song-info .songer a").text(songlist[songIndex].singer);
     $(".song-info .song-sour a").text(songlist[songIndex].album);
     $(".song-end-state").text(songlist[songIndex].time);
     //加上wave图标
    $(".songlist-item .wave").eq(songIndex).css("display","inline-block");
    /* $(event).parent().children().children(".wave").css("display","inline-block"); */
    $(".songlist-item .wave").eq(songIndex).parent().parent().siblings().children().children(".wave").css("display","none");
    //清除上一首歌词
    $(".song-lyric>div").children().remove(); 
    console.log("lyricShow",name,songIndex);
    //加载歌词  
    for(var index in lrcs){
        var songname=lrcs[index].song;
        var lyric=lrcs[index].lyric;
        //判断歌曲名显示对应歌词
        if(name==songname){
            for(var i in lyric){
                var lyriContent=lyric[i].lineLyric;
                var lyriTime=lyric[i].time+1;
                $(".song-lyric>div").append("<p date-time="+lyriTime+">"+lyriContent+"</p>");
                $(".song-lyric p").attr("class","song-lyric-format");
            }
        }
    }
}
//高亮显示歌词
myaudio.ontimeupdate=function(){
    //实时更新歌词时间
    var time=Math.ceil(myaudio.currentTime);
    var timeTotal=Math.ceil(myaudio.duration);
    $(".songBarDot")[0].style.left=songBarDotX+(time/timeTotal)*songBarWidth+"px";
    $(".songBarNow")[0].style.width=(time/timeTotal)*100+"%";
    var m=parseInt(time/60);
    m=m<10?"0"+m:m;
    var s=parseInt(time%60);
    s=s<10?"0"+s:s;
    $(".song-time-state").text(m+":"+s);
    //高亮显示歌词                                   
   var len=$(".song-lyric p").length;
   var col;
   for(var i=0;i<len;i++){
       if(time==$(".song-lyric p:eq("+i+")").attr("date-time")){   
            $(".song-lyric p:eq("+i+")").css("color","red");
            $(".song-lyric p:eq("+i+")").siblings().css("color","black");
            i<6?col=0:(col=-30*(i-4));
            $(".song-lyric>div").css("transform","translateY("+col+"px)");
            //桌面歌词
            var m=i+1;
            $(".songLyricOnDesk p:first").text($(".song-lyric p:eq("+i+")").text());
            $(".songLyricOnDesk p:eq(1)").text($(".song-lyric p:eq("+m+")").text());
            $(".songLyricOnDesk p:first").attr("style","color:red");
        }
   }
}
/* 歌曲播放控制功能 */
//设置一个noplay表示歌曲的开关功能，0表示关闭，1表示打开
var noplay;
$("#myplay").hasClass('songStop')?noplay=0:noplay=1;
$("#myplay")[0].addEventListener('click',play,false);
function play(){
    console.log("播放音乐"+ noplay);
    if(noplay==0){
        $("#myaudio")[0].play();
        //改变播放图标
        $("#myplay").removeClass("songStop").addClass("songStart");
        //播放bar下来
        $(".playerbar").css("transform","rotate(40deg)"); 
        //专辑旋转
        $(".albumcover").addClass("albumRotate");
        //专辑旋转被停止，启动旋转
        $(".albumRotate").css("animation-play-state","running");    
        noplay=1;
    }else if(noplay==1){
        $("#myaudio")[0].pause();
        $("#myplay").removeClass("songStart").addClass("songStop");
        $(".playerbar").css("transform","rotate(20deg)");
        $(".albumRotate").css("animation-play-state","paused");
        noplay=0;
    }
}
/* 上一首 */
$(".songPrev")[0].addEventListener("click",songPrevPlay,false);
function songPrevPlay(){
    console.log("cycleMode全局:"+cycleMode);
    
    if(cycleMode==1){
        (songIndex-1)>=0?($("#myaudio").attr("src",songlist[songIndex-1].url)):($("#myaudio").attr("src",songlist[songTotal-1].url));
        songIndex=(songIndex-1)>=0?--songIndex:songTotal-1;  
        //改变背景图片
        $(".song-img").css("background-image","url("+songlist[songIndex].pic+")");  
        //歌词显示
        lyricShow(songlist[songIndex].songid,songIndex,this);
    }else if(cycleMode==2){
        $("#myaudio").attr("src",songlist[songIndex].url);  
        //改变背景图片
        $(".song-img").css("background-image","url("+songlist[songIndex].pic+")"); 
        //歌词显示
        lyricShow(songlist[songIndex].songid,songIndex,this);  
    }else if(cycleMode==3){
        var songNext=parseInt(Math.random()*songTotal);
        $("#myaudio").attr("src",songlist[songNext].url); 
        //改变背景图片
        $(".song-img").css("background-image","url("+songlist[songNext].pic+")"); 
        //歌词显示
        lyricShow(songlist[songNext].songid,songNext,this);   
    }
    //播放条回原点
    noplay=0;
    play();
    $(".songBarDot")[0].style.left= -4+"px";
    $(".songBarNow")[0].style.width= 0;
} 
/* 下一首 */
$(".songNext")[0].addEventListener("click",songNextPlay,false);
function songNextPlay(){
    
    if(cycleMode==1){
        //顺序播放模式
        (songIndex+1)<songTotal?($("#myaudio").attr("src",songlist[songIndex+1].url)):($("#myaudio").attr("src",songlist[0].url));
        songIndex=(songIndex+1)<songTotal?++songIndex:0;
        //歌词显示
        lyricShow(songlist[songIndex].songid,songIndex,this);
        $(".song-img").css("background-image","url("+songlist[songIndex].pic+")");     
    }else if(cycleMode==2){
        $("#myaudio").attr("src",songlist[songIndex].url);
        lyricShow(songlist[songIndex].songid,songIndex,this);
        $(".song-img").css("background-image","url("+songlist[songIndex].pic+")"); 
    }else if(cycleMode==3){
        var songNext=parseInt(Math.random()*songTotal);
        $("#myaudio").attr("src",songlist[songNext].url);
        lyricShow(songlist[songNext].songid,songNext,this);  
        $(".song-img").css("background-image","url("+songlist[songNext].pic+")");    
    }
    //播放条回原点
    $(".songBarDot")[0].style.left= -4+"px";
    $(".songBarNow")[0].style.width= 0;
    noplay=0;
    play();
}
/* 歌曲列表隐藏及显示 */
$(".song-list").click(function(){
    if($(".songlist").is(":hidden")){
        $(".songlist").show();
    }else{
        $(".songlist").hide(); 
    }
});
/* 播放器进度条 */
var mOriginPosX=getIE($(".songBarDot")[0]);//鼠标初始位置
var songStateOriginPosX=getIE($(".songState")[0]);//鼠标点击的初始位置
var songBarWidth=parseInt($(".songState")[0].style.width);
var songBarDotX=parseInt($(".songBarDot")[0].style.left);//初始位置：-4
//点击进度条
$(".songState")[0].addEventListener("click",mclick,false);
function mclick(e){
    var disClickX=parseInt(e.pageX-songStateOriginPosX);
    console.log(e.pageX,mOriginPosX,songStateOriginPosX,disClickX);
    $(".songBarDot")[0].style.left=songBarDotX+disClickX+"px";
    $(".songBarNow")[0].style.width=(disClickX/songBarWidth)*100+"%";
    myaudio.currentTime=myaudio.duration*(disClickX/songBarWidth);
    noplay=0;
    play();
}
//控制进度条移动，同时获得移动的坐标
$(".songBarDot")[0].addEventListener("mousedown",move,false);
//获得任意元素的位置，相对于body
function getIE(e){
      var t=e.offsetTop;
      var l=e.offsetLeft;
      while(e=e.offsetParent){
        t+=e.offsetTop;
        l+=e.offsetLeft;
      }
    return l;
}
function move(e){
    
        /* offsetLeft 获取的是相对于父对象的左边距
        left 获取或设置相对于 具有定位属性(position定义为relative)的父对象 的左边距
        如果父div的position定义为relative,子div的position定义为absolute，那么子div的style.left的值是相对于父div的值，
        这同offsetLeft是相同的，区别在于：
        1. style.left 返回的是字符串，如28px，offsetLeft返回的是数值28，如果需要对取得的值进行计算，
        还用offsetLeft比较方便。
        2. style.left是读写的，offsetLeft是只读的，所以要改变div的位置，只能修改style.left。
        3. style.left的值需要事先定义，否则取到的值为空。而且必须要定义在html里，我做过试验，如果定义在
        css里，style.left的值仍然 为空，这就是我刚开始碰到的问题，总是取不到style.left的值。
        offsetLeft则仍然能够取到，无需事先定义div的位置。 */
    mPosX=e.pageX;
    //进度条位置=鼠标移动-最初鼠标位置
    document.onmousemove=function(e){
        
        var disX=e.pageX-mPosX;
        var originDisX=e.pageX-mOriginPosX;
        console.log(songBarWidth,mOriginPosX,e.pageX,e,mPosX,originDisX,disX);
        if(originDisX<0){
            $(".songBarDot")[0].style.left= -4+"px";
            $(".songBarNow")[0].style.width= 0;
            myaudio.currentTime=myaudio.duration*0;
            noplay=0;
            play();
        }else if(originDisX>=0 && originDisX<=songBarWidth){
            $(".songBarDot")[0].style.left=songBarDotX+disX+"px";
            $(".songBarNow")[0].style.width=(originDisX/songBarWidth)*100+"%";
            myaudio.currentTime=myaudio.duration*(originDisX/songBarWidth);
            noplay=0;
            play();
        }else if(originDisX>songBarWidth){
                if(noplay==1 && originDisX>songBarWidth){
                    songNextPlay();
                    $(".songBarDot")[0].style.left= -4+"px";
                    $(".songBarNow")[0].style.width= 0;
                }else{
                    $(".songBarDot")[0].style.left=songBarWidth+"px";
                    $(".songBarNow")[0].style.width=100+"%";
                }
            myaudio.currentTime=myaudio.duration;
        }
        /* console.log($(".songBarDot")[0].style.left); */
        document.onmouseup=function(){
            document.onmousemove=null;
            
        }
    }
}
/* 桌面歌词显示控制 */
$("#mylyricOndesk")[0].addEventListener("click",lyricOnDesk,false);
function lyricOnDesk(){
    if($(".songLyricOnDesk").is(":visible")){
        $(".songLyricOnDesk").hide();
        $("#mylyricOndesk").attr("class","playerIcon playerControlButtomOff");
    }else{
        $(".songLyricOnDesk").show(); 
        $("#mylyricOndesk").attr("class","playerIcon playerControlButtomOn");
    }
}
/* 点击登陆出现登录框 */
$(".logn-state").click(function(){
    $("#lognControl").css("visibility","visible");
});

/* 登录框UI */
// 登陆方式选择
$(".lognChoose>span:first").click(function(){
    $("#lognControl>.QQLogin").css("display","block");
    $("#lognControl>.wechartLogin").css("display","none");
});
$(".lognChoose>span:eq(1)").click(function(){
    $("#lognControl>.QQLogin").css("display","none");
    $("#lognControl>.wechartLogin").css("display","block");
});
//退出登陆选择方式
$(".lognChoose>span:last").click(function(){
    $("#lognControl").css("visibility","hidden");
    // $(".loginText4").css("display","none");
});
$(".QQLogin .QQLoginQuick .QQLoginUser .user").click(function(){
    $(".avatar").css("background","url(img/g_min.jpg)");
    $("#lognControl").css("visibility","hidden");
    $(".logn-state").text("用户1");
});
$(".QQLogin .QQLoginQuick .lognInform a:first").click(function(){
    $(".QQLoginQuick").css("display","none");
    $(".QQLoginSrc").css("display","block"); 
});
$(".QQLogin .QQLoginSrc p a:first").click(function(){
    $(".QQLoginQuick").css("display","block");
    $(".QQLoginSrc").css("display","none"); 
});
$(".QQLogin .QQLoginSrc form input:last").click(function(){
    var user=$(this).parent().children().children("input")[0].value;
    var password=$(this).parent().children().children("input")[1].value;
    console.log(user,password);
    if(user=="1"&&password=="1"){
        $(".avatar").css("background","url(img/g_min.jpg)");
        $(".loginUserShow").css("display","inline-block");
        $("#lognControl").css("visibility","hidden");
        $(".logn-state").text("用户1");
    }else{
        $(".alertInform").text("账号密码输入错误!! user=1 password=1")
    }
});
$(".QQLogin .QQLoginSrc form input[type='text']").click(function(){
    console.log(this);
    /* var spanText=$(this).siblings("span").text();
    if(spanText=!""){
        $(this).siblings("span").text("");
    }else{
        $(this).siblings("span").text("支持QQ号/邮箱/手机号登陆");
    } */
    $(this).siblings("span").css("visibility","hidden");
});
$(".QQLogin .QQLoginSrc form input[type='password']").click(function(){
    console.log(this);
    $(this).siblings("span").css("visibility","hidden");
});
$("#mycolor").change(function(){
    console.log(this.value);
    $("#header").css("background-color",this.value);
    $("#player-control").css("background-color",this.value);
})